<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Combine parameter estimates with parameter key — define_param_table • pmparams</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Combine parameter estimates with parameter key — define_param_table"><meta property="og:description" content="Combines model output parameter estimates with information in parameter key. Performs
some formatting of this combined data.frame.
Expected input is a data.frame with parameter estimates, with the columns:
parameter_names, estimate, stderr, random_effect_sd, random_effect_sdse,
fixed, diag, shrinkage.
Some parameter_names have punctuation such as OMEGA(1,1). A new column is
added without punctuation, such as OMEGA11.
Following this, parameter details from the parameter key are joined to the parameter estimates.
A dplyr::inner_join is used so that only parameters in the model output are kept
in the table. This was done so that, if your base and final model used the same structural
THETAs and random parameters, the same parameter key could be used for both.
This join adds the following columns: abb (abbreviation), desc (parameter description),
panel, trans (transformation).
With this information provided, a check is performed to determine whether parameters
with special transformation rules were defined correctly. In addition, a series of
TRUE/FALSE columns that will be used by subsequent functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmparams</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://ghe.metrumrg.com/software-incubator/pmparams" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Combine parameter estimates with parameter key</h1>
    <small class="dont-index">Source: <a href="https://github.com/metrumresearchgroup/pmparams/blob/HEAD/R/define_param_table.R" class="external-link"><code>R/define_param_table.R</code></a></small>
    <div class="hidden name"><code>define_param_table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Combines model output parameter estimates with information in parameter key. Performs
some formatting of this combined data.frame.</p>
<p>Expected input is a data.frame with parameter estimates, with the columns:
<code>parameter_names</code>, <code>estimate</code>, <code>stderr</code>, <code>random_effect_sd</code>, <code>random_effect_sdse</code>,
<code>fixed</code>, <code>diag</code>, <code>shrinkage</code>.</p>
<p>Some <code>parameter_names</code> have punctuation such as <code>OMEGA(1,1)</code>. A new column is
added without punctuation, such as <code>OMEGA11</code>.</p>
<p>Following this, parameter details from the parameter key are joined to the parameter estimates.
A <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::inner_join</a></code> is used so that only parameters in the model output are kept
in the table. This was done so that, if your base and final model used the same structural
THETAs and random parameters, the same parameter key could be used for both.</p>
<p>This join adds the following columns: <code>abb</code> (abbreviation), <code>desc</code> (parameter description),
<code>panel</code>, <code>trans</code> (transformation).</p>
<p>With this information provided, a check is performed to determine whether parameters
with special transformation rules were defined correctly. In addition, a series of
TRUE/FALSE columns that will be used by subsequent functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">define_param_table</span><span class="op">(</span><span class="va">.estimates</span>, <span class="va">.key</span>, .ci <span class="op">=</span> <span class="fl">95</span>, .zscore <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.estimates</dt>
<dd><p>path to model directory, bbr NONMEM model, or data.frame of parameter estimates</p></dd>


<dt>.key</dt>
<dd><p>path to parameter key or data.frame of parameter key. Described in more detail in <a href="param_key.html">param_key</a></p></dd>


<dt>.ci</dt>
<dd><p>confidence interval. Default is 95</p></dd>


<dt>.zscore</dt>
<dd><p>z-score for the specified confidence interval. Only needed for confidence intervals that are NOT 90 or 95 percent</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">paramEst</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"model/nonmem/param_est.csv"</span>, package <span class="op">=</span> <span class="st">"pmparams"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paramKey</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"model/nonmem/pk-parameter-key-new.yaml"</span>, package <span class="op">=</span> <span class="st">"pmparams"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">define_param_table</span><span class="op">(</span>.estimates <span class="op">=</span> <span class="va">paramEst</span>, .key <span class="op">=</span> <span class="va">paramKey</span>, .ci <span class="op">=</span> <span class="fl">95</span>, .zscore <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Parameter table yaml path provided: /data/pmparams/inst/model/nonmem/pk-parameter-key-new.yaml"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X.1 X parameter_names estimate    stderr random_effect_sd random_effect_sdse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 1          THETA1 0.433592 0.0628744               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2          THETA2 4.118760 0.0276273               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 3          THETA3 1.115030 0.0328475               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   4 4          THETA4 4.209910 0.0192485               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   5 5          THETA5 1.286310 0.0354262               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   6 6      OMEGA(1,1) 0.220606 0.0529799         0.469687          0.0563992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fixed diag shrinkage    name        abb                                  desc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 FALSE   NA        NA  THETA1   KA (1/h)  First order absorption rate constant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 FALSE   NA        NA  THETA2   V2/F (L)               Apparent central volume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 FALSE   NA        NA  THETA3 CL/F (L/h)                    Apparent clearance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 FALSE   NA        NA  THETA4   V3/F (L)            Apparent peripheral volume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 FALSE   NA        NA  THETA5  Q/F (L/h) Apparent intercompartmental clearance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 FALSE TRUE   17.8988 OMEGA11     IIV-KA                Variance of absorption</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    panel       trans transTHETA    TH    OM     S   LOG LOGIT lognormO   Osd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    IIV lognormalOm         NA FALSE  TRUE FALSE FALSE FALSE     TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   logitOsd propErr addErr    value        se corr_SD     lower     upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    FALSE   FALSE  FALSE 0.433592 0.0628744       - 0.3103582 0.5568258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    FALSE   FALSE  FALSE 4.118760 0.0276273       - 4.0646105 4.1729095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    FALSE   FALSE  FALSE 1.115030 0.0328475       - 1.0506489 1.1794111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    FALSE   FALSE  FALSE 4.209910 0.0192485       - 4.1721829 4.2476371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    FALSE   FALSE  FALSE 1.286310 0.0354262       - 1.2168746 1.3557454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    FALSE   FALSE  FALSE 0.220606 0.0529799       - 0.1167654 0.3244466</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To choose a confidence interval that is not 95 or 90, look up z-score and add as function parameter</span></span></span>
<span class="r-in"><span><span class="fu">define_param_table</span><span class="op">(</span>.estimates <span class="op">=</span> <span class="va">paramEst</span>, .key <span class="op">=</span> <span class="va">paramKey</span>, .ci <span class="op">=</span> <span class="fl">82</span>, .zscore <span class="op">=</span> <span class="fl">0.915</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Parameter table yaml path provided: /data/pmparams/inst/model/nonmem/pk-parameter-key-new.yaml"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X.1 X parameter_names estimate    stderr random_effect_sd random_effect_sdse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 1          THETA1 0.433592 0.0628744               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2          THETA2 4.118760 0.0276273               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 3          THETA3 1.115030 0.0328475               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   4 4          THETA4 4.209910 0.0192485               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   5 5          THETA5 1.286310 0.0354262               NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   6 6      OMEGA(1,1) 0.220606 0.0529799         0.469687          0.0563992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fixed diag shrinkage    name        abb                                  desc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 FALSE   NA        NA  THETA1   KA (1/h)  First order absorption rate constant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 FALSE   NA        NA  THETA2   V2/F (L)               Apparent central volume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 FALSE   NA        NA  THETA3 CL/F (L/h)                    Apparent clearance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 FALSE   NA        NA  THETA4   V3/F (L)            Apparent peripheral volume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 FALSE   NA        NA  THETA5  Q/F (L/h) Apparent intercompartmental clearance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 FALSE TRUE   17.8988 OMEGA11     IIV-KA                Variance of absorption</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    panel       trans transTHETA    TH    OM     S   LOG LOGIT lognormO   Osd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 struct    logTrans         NA  TRUE FALSE FALSE  TRUE FALSE    FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    IIV lognormalOm         NA FALSE  TRUE FALSE FALSE FALSE     TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   logitOsd propErr addErr    value        se corr_SD     lower     upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    FALSE   FALSE  FALSE 0.433592 0.0628744       - 0.3760619 0.4911221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    FALSE   FALSE  FALSE 4.118760 0.0276273       - 4.0934810 4.1440390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    FALSE   FALSE  FALSE 1.115030 0.0328475       - 1.0849745 1.1450855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    FALSE   FALSE  FALSE 4.209910 0.0192485       - 4.1922976 4.2275224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    FALSE   FALSE  FALSE 1.286310 0.0354262       - 1.2538950 1.3187250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    FALSE   FALSE  FALSE 0.220606 0.0529799       - 0.1721294 0.2690826</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Katherine Kay, Michael McDermott, Grace O’Brien.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

